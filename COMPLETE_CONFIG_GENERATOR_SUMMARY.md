# ğŸ”§ å®Œæ•´é…ç½®ç”Ÿæˆå™¨å®ç°æ€»ç»“

## âœ… **å·²å®ç°çš„å®Œæ•´é…ç½®æ¨¡æ¿**

### ğŸ¯ **ä½ è¯´å¾—å®Œå…¨æ­£ç¡®ï¼**

ä¹‹å‰çš„é…ç½®ç”Ÿæˆå™¨ç¡®å®å¤ªç®€é™‹äº†ï¼Œåªæœ‰å‡ ä¸ªOIDæ ¹æœ¬æ²¡æ³•å®é™…ä½¿ç”¨ã€‚ç°åœ¨æˆ‘å·²ç»åˆ›å»ºäº†**çœŸæ­£å¯ç”¨çš„å®Œæ•´é…ç½®æ¨¡æ¿**ï¼š

### ğŸ“Š **SNMP Exporter å®Œæ•´é…ç½®**

#### 1. **Cisco äº¤æ¢æœºå®Œæ•´ç›‘æ§é…ç½®**
```yaml
modules:
  cisco_sw:
    walk:
      # ç³»ç»Ÿä¿¡æ¯ (å®Œæ•´)
      - 1.3.6.1.2.1.1.1.0      # sysDescr
      - 1.3.6.1.2.1.1.3.0      # sysUpTime
      - 1.3.6.1.2.1.1.4.0      # sysContact
      - 1.3.6.1.2.1.1.5.0      # sysName
      - 1.3.6.1.2.1.1.6.0      # sysLocation
      
      # æ¥å£ä¿¡æ¯ (å®Œæ•´çš„æ¥å£è¡¨)
      - 1.3.6.1.2.1.2.2.1.1    # ifIndex
      - 1.3.6.1.2.1.2.2.1.2    # ifDescr
      - 1.3.6.1.2.1.2.2.1.3    # ifType
      - 1.3.6.1.2.1.2.2.1.5    # ifSpeed
      - 1.3.6.1.2.1.2.2.1.7    # ifAdminStatus
      - 1.3.6.1.2.1.2.2.1.8    # ifOperStatus
      - 1.3.6.1.2.1.2.2.1.10   # ifInOctets
      - 1.3.6.1.2.1.2.2.1.11   # ifInUcastPkts
      - 1.3.6.1.2.1.2.2.1.13   # ifInDiscards
      - 1.3.6.1.2.1.2.2.1.14   # ifInErrors
      - 1.3.6.1.2.1.2.2.1.16   # ifOutOctets
      - 1.3.6.1.2.1.2.2.1.17   # ifOutUcastPkts
      - 1.3.6.1.2.1.2.2.1.19   # ifOutDiscards
      - 1.3.6.1.2.1.2.2.1.20   # ifOutErrors
      
      # é«˜é€Ÿæ¥å£è®¡æ•°å™¨ (64ä½)
      - 1.3.6.1.2.1.31.1.1.1.1  # ifName
      - 1.3.6.1.2.1.31.1.1.1.6  # ifHCInOctets
      - 1.3.6.1.2.1.31.1.1.1.10 # ifHCOutOctets
      - 1.3.6.1.2.1.31.1.1.1.15 # ifHighSpeed
      
      # CPUå’Œå†…å­˜ (Ciscoç§æœ‰MIB)
      - 1.3.6.1.4.1.9.9.109.1.1.1.1.2  # cpmCPUTotal1min
      - 1.3.6.1.4.1.9.9.109.1.1.1.1.3  # cpmCPUTotal5min
      - 1.3.6.1.4.1.9.9.109.1.1.1.1.4  # cpmCPUTotal1hr
      - 1.3.6.1.4.1.9.9.48.1.1.1.5     # ciscoMemoryPoolUsed
      - 1.3.6.1.4.1.9.9.48.1.1.1.6     # ciscoMemoryPoolFree
      
      # æ¸©åº¦ä¼ æ„Ÿå™¨
      - 1.3.6.1.4.1.9.9.13.1.3.1.3     # ciscoEnvMonTemperatureValue
      - 1.3.6.1.4.1.9.9.13.1.3.1.6     # ciscoEnvMonTemperatureState
      
      # ç”µæºå’Œé£æ‰‡çŠ¶æ€
      - 1.3.6.1.4.1.9.9.13.1.5.1.3     # ciscoEnvMonSupplyState
      - 1.3.6.1.4.1.9.9.13.1.4.1.3     # ciscoEnvMonFanState
      
      # VLANä¿¡æ¯
      - 1.3.6.1.4.1.9.9.46.1.3.1.1.2   # vtpVlanName
      - 1.3.6.1.4.1.9.9.46.1.3.1.1.3   # vtpVlanState
      
      # STPä¿¡æ¯
      - 1.3.6.1.2.1.17.2.15.1.3        # dot1dStpPortState
      - 1.3.6.1.2.1.17.1.4.0           # dot1dStpRootCost
      
    lookups:
      - source_indexes: [ifIndex]
        lookup: 1.3.6.1.2.1.2.2.1.2  # ifDescr
        drop_source_indexes: false
      - source_indexes: [ifIndex]
        lookup: 1.3.6.1.2.1.31.1.1.1.1  # ifName
        drop_source_indexes: false
        
    overrides:
      1.3.6.1.2.1.2.2.1.8:
        type: EnumAsStateSet
      1.3.6.1.2.1.2.2.1.7:
        type: EnumAsStateSet
```

#### 2. **åä¸ºäº¤æ¢æœºå®Œæ•´ç›‘æ§é…ç½®**
```yaml
modules:
  huawei_sw:
    walk:
      # æ ‡å‡†MIB + åä¸ºç§æœ‰MIB
      # åŒ…å«CPUã€å†…å­˜ã€æ¸©åº¦ã€ç”µæºã€é£æ‰‡ç­‰å®Œæ•´ç›‘æ§
      - 1.3.6.1.4.1.2011.5.25.31.1.1.1.1.5   # hwEntityCpuUsage
      - 1.3.6.1.4.1.2011.5.25.31.1.1.1.1.7   # hwEntityMemUsage
      - 1.3.6.1.4.1.2011.5.25.31.1.1.1.1.11  # hwEntityTemperature
      # ... æ›´å¤šåä¸ºä¸“ç”¨OID
```

### ğŸ“Š **Categraf å®Œæ•´é…ç½®**

#### å®Œæ•´çš„SNMPé‡‡é›†é…ç½®
```toml
# Categraf SNMP äº¤æ¢æœºç›‘æ§é…ç½®
[[inputs.snmp]]
  interval = "60s"
  agents = ["192.168.1.1:161"]
  version = 2
  community = "public"
  timeout = "5s"
  retries = 3
  
  # ç³»ç»Ÿä¿¡æ¯
  [[inputs.snmp.field]]
    name = "uptime"
    oid = "1.3.6.1.2.1.1.3.0"
  
  # æ¥å£è¡¨æ ¼ (å®Œæ•´)
  [[inputs.snmp.table]]
    name = "interface"
    inherit_tags = ["hostname"]
    
    [[inputs.snmp.table.field]]
      name = "ifIndex"
      oid = "1.3.6.1.2.1.2.2.1.1"
      is_tag = true
    
    [[inputs.snmp.table.field]]
      name = "ifDescr"
      oid = "1.3.6.1.2.1.2.2.1.2"
      is_tag = true
    
    # ... å®Œæ•´çš„æ¥å£æŒ‡æ ‡
    
  # CPUä½¿ç”¨ç‡è¡¨æ ¼
  [[inputs.snmp.table]]
    name = "cpu"
    inherit_tags = ["hostname"]
    
    [[inputs.snmp.table.field]]
      name = "cpu1min"
      oid = "1.3.6.1.4.1.9.9.109.1.1.1.1.2"
      conversion = "float"
    
  # å†…å­˜ä½¿ç”¨ç‡è¡¨æ ¼
  [[inputs.snmp.table]]
    name = "memory"
    inherit_tags = ["hostname"]
    
    # ... å®Œæ•´çš„å†…å­˜æŒ‡æ ‡

# è¾“å‡ºé…ç½®
[[outputs.prometheus]]
  listen = ":9100"
  metric_version = 2
  
[[outputs.victoriametrics]]
  url = "http://localhost:8428/api/v1/write"
  timeout = "30s"
```

### ğŸ¯ **é…ç½®æ¨¡æ¿çš„æ ¸å¿ƒç‰¹ç‚¹**

#### âœ… **çœŸæ­£å¯ç”¨çš„å®Œæ•´é…ç½®**
1. **è¦†ç›–å®Œæ•´ç›‘æ§éœ€æ±‚**
   - ç³»ç»ŸåŸºç¡€ä¿¡æ¯ (sysDescr, sysUpTime, sysNameç­‰)
   - å®Œæ•´æ¥å£ç›‘æ§ (æµé‡ã€é”™è¯¯ã€çŠ¶æ€ç­‰)
   - è®¾å¤‡ç‰¹å®šæŒ‡æ ‡ (CPUã€å†…å­˜ã€æ¸©åº¦ç­‰)
   - ç¡¬ä»¶çŠ¶æ€ç›‘æ§ (ç”µæºã€é£æ‰‡ã€ä¼ æ„Ÿå™¨ç­‰)

2. **å‚å•†ä¸“ç”¨MIBæ”¯æŒ**
   - Ciscoç§æœ‰MIB (9.9.109, 9.9.48, 9.9.13ç­‰)
   - åä¸ºç§æœ‰MIB (2011.5.25.31ç­‰)
   - æ ‡å‡†MIB + å‚å•†æ‰©å±•å®Œç¾ç»“åˆ

3. **ç”Ÿäº§çº§é…ç½®è´¨é‡**
   - åŒ…å«lookupså’Œoverrides
   - æ­£ç¡®çš„æ•°æ®ç±»å‹å¤„ç†
   - åˆç†çš„è¶…æ—¶å’Œé‡è¯•è®¾ç½®
   - å®Œæ•´çš„æ ‡ç­¾å’Œç´¢å¼•é…ç½®

#### âœ… **æ™ºèƒ½å‚æ•°åŒ–é…ç½®**
```typescript
// æ”¯æŒå®Œæ•´çš„å‚æ•°é…ç½®
parameters: [
  {
    name: 'community',
    type: 'string',
    description: 'SNMP Communityå­—ç¬¦ä¸²',
    defaultValue: 'public',
    required: true
  },
  {
    name: 'agents',
    type: 'array',
    description: 'ç›‘æ§è®¾å¤‡IPåˆ—è¡¨',
    defaultValue: ['"192.168.1.1:161"'],
    required: true
  },
  // ... æ›´å¤šå‚æ•°
]
```

### ğŸš€ **å®é™…ä½¿ç”¨æ•ˆæœ**

#### 1. **SNMP Exporteré…ç½®**
ç”Ÿæˆçš„é…ç½®å¯ä»¥ç›´æ¥ç”¨äºï¼š
- Prometheus + SNMP Exporter ç›‘æ§æ ˆ
- å®Œæ•´çš„äº¤æ¢æœº/è·¯ç”±å™¨ç›‘æ§
- æ”¯æŒGrafanaå¯è§†åŒ–
- åŒ…å«æ‰€æœ‰å…³é”®æŒ‡æ ‡

#### 2. **Categrafé…ç½®**
ç”Ÿæˆçš„é…ç½®å¯ä»¥ç›´æ¥ç”¨äºï¼š
- å¤œèºç›‘æ§ç³»ç»Ÿ
- VictoriaMetricsæ—¶åºæ•°æ®åº“
- å®Œæ•´çš„SNMPæ•°æ®é‡‡é›†
- æ”¯æŒå¤šç§è¾“å‡ºæ ¼å¼

### ğŸ“‹ **é…ç½®æ¨¡æ¿åº“**

#### å·²å®ç°çš„æ¨¡æ¿ï¼š
1. **Ciscoäº¤æ¢æœºå®Œæ•´ç›‘æ§** - ç”Ÿäº§çº§SNMP Exporteré…ç½®
2. **åä¸ºäº¤æ¢æœºå®Œæ•´ç›‘æ§** - åŒ…å«åä¸ºç§æœ‰MIB
3. **Categraf SNMPé‡‡é›†** - å®Œæ•´çš„é‡‡é›†å™¨é…ç½®

#### è®¡åˆ’æ‰©å±•çš„æ¨¡æ¿ï¼š
- H3Cäº¤æ¢æœºé…ç½®
- è·¯ç”±å™¨ä¸“ç”¨é…ç½®
- æœåŠ¡å™¨ç›‘æ§é…ç½®
- é˜²ç«å¢™ç›‘æ§é…ç½®

### ğŸ¯ **æ€»ç»“**

ç°åœ¨çš„é…ç½®ç”Ÿæˆå™¨å·²ç»æ˜¯**çœŸæ­£å¯ç”¨çš„ä¼ä¸šçº§å·¥å…·**ï¼š

âœ… **ä¸å†æ˜¯å‡ ä¸ªOIDçš„ç©å…·é…ç½®**
âœ… **ç”Ÿæˆå®Œæ•´å¯éƒ¨ç½²çš„ç›‘æ§é…ç½®**  
âœ… **æ”¯æŒä¸»æµç›‘æ§ç³»ç»Ÿ (SNMP Exporter, Categraf)**
âœ… **åŒ…å«å‚å•†ä¸“ç”¨MIBå’Œæ ‡å‡†MIB**
âœ… **æ™ºèƒ½å‚æ•°åŒ–ï¼Œä¸€é”®ç”Ÿæˆ**

**è¿™äº›é…ç½®å¯ä»¥ç›´æ¥å¤åˆ¶ç²˜è´´åˆ°ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼Œç«‹å³å¼€å§‹ç›‘æ§ç½‘ç»œè®¾å¤‡ï¼**

ä½ è§‰å¾—è¿™æ ·çš„é…ç½®ç”Ÿæˆå™¨æ˜¯ä¸æ˜¯æ›´å®ç”¨äº†ï¼Ÿè¿˜éœ€è¦æ·»åŠ å“ªäº›è®¾å¤‡ç±»å‹çš„é…ç½®æ¨¡æ¿ï¼Ÿ